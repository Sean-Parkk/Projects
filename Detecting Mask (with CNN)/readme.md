# 마스크와 턱스크, 코스크를 구별할 수 있을까? (with CNN)
<iframe width="560" height="315" src="https://www.youtube.com/embed/1PWrxCgjWIw" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## 주제 선정 이유 (목적)

- 마스크랑 턱스크랑 구분하는 문제
    - 최근 지하철에서 마스크를 제대로 착용하지 않는 사람들이 많다.
    - 그래서 그런지 최근 올바른 마스크 착용법에 관한 포스터나 현수막 등이 자주 보인다.
    - 올바르게 **마스크를 착용한 사람과 그렇지 않은 사람을 구별**하기 위해 프로젝트를 시작했다.

## 데이터 수집

- 인스타그램에서 해시태그를 검색하여 이미지를 수집했다.
    - #턱스크, #마스크, #셀카 등
    - 총 데이터 4,840개를 수집했다.
        - 어떤 사진인지 내 사진으로 예시 첨부

- 데이터 라벨링
    - 해시태그로 검색하여 데이터를 수집하였지만,
    - 문제점이 발생
        - 실제 이미지들은 이미지가 뒤죽박죽 (턱스크로 검색했는데 제대로 착용한 사진이 나온다던지)
        - 얼굴이 아닌 사진들도 많았음
    - 해결
        - 직접 하나씩 처리함
            - 얼굴이 아닌 사진들은 삭제
            - 이미지 분류는 직접 수기로 진행 (일반 셀카 + 턱스크 + 코스크 || 올바른 착용)

## 데이터 전처리

- 학습을 위해 얼굴 부분만 크롭해야함.
- 이를 위해 기존의 face detection 모델을 활용
    - keras와 OOO을 사용했고, keras가 비교적 엄격한 기준으로 분류
    - 정확한 학습을 위해 일부 샘플을 포기하더라도 keras를 활용하여 제대로 얼굴만 분류
- 하지만 얼굴이 아닌데 얼굴이라고 인식하는 경우도 있었음.
    - 예를들어, 스타벅스 세이렌 로고 등 (사진 첨부하기)
- 이미지 배열화, BGR2RGB, resize, normalization 등의 전처리 수행

## 모델링

### 셀프 모델링

- 텐서플로우 직접 쌓기 no keras
    - 텐서플로우로?
    - numpy로 해보면?
- 직접 Convolutional Network 구현
    - 어떻게 층을 쌓았는지
    - 에폭, 학습률 등
- 한계점
    - 코스크를 잘 구별하지 못했다.
        - 이유는, 코스크의 사진이 부족했음.
    - 해결
        - Image generator 기법으로 기존 사진을 flip, crop, zoom함으로써 1,000개의 추가 샘플 생성
- 결과
    - 구현 사진

### VGG

- 모델 사진

### ResNet

- 모델 사진

### MobileNet

- 모델 사진

## 회고

- 데이터가 약 5,000개
    - 근데 왜 성능이 좋지?
    - 마스크 분류하는 문제가 어려운 문제가 아닌가?
        - 마스크 색상이랑 얼굴색상 다름
        - 입 코의 피처가 안 나옴
        - + 이진분류
- 필터에서 뽑은 잡아낸 패턴 시각화 가능할까?
    - Feature map visualization
    - 
- 일정을 어떻게 맞췄는지
- Facedetection에 대한 아쉬운 부분
    - 모델들 비교나 원리같은거~?
