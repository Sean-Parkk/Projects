# 마스크와 턱스크, 코스크를 구별할 수 있을까? (with CNN)
* Date: 20.09 ~ 20.10
* 이 주제로 발표를 했었습니다!
    * [발표 자료](https://slides.com/seanparkk/deck-098e47)
* 결과물
![image](images/test_img.gif)
## 문제 정의
- 2020년을 요약하면,
    - 코로나 바이러스, 마스크가 될 것 같다.
    - 처음엔 불편하기만 했던 마스크가, 이제는 없으면 불안한 존재가 되었다.
- 하지만 모두가 마스크를 올바르게 쓰는 것은 아니다.
    - 마스크를 쓰면 숨쉬기가 불편하다.
    - 그래서 코나 턱에 걸치는, 일명 코스크와 마스크 등 올바르지 않게 착용하는 사례가 늘고있다.
        - (코, 턱스크 등을 하면 오히려 마스크를 쓰지 않은 것보다 더 위험하다고 하다.)
- 어떻게 하면 마스크를 올바르게 착용한 사람과 그렇지 않은 사람을 구별할 수 있을까?
    - [image](images/0.png)
    - 위 사진을 육안으로 확인하면 누가 오라르게 착용했는지 쉽게 구별할 수 있다.
        - **근데 만약 이렇게 구별하는 일을 하루종일 해야한다면, 사람보다는 컴퓨터에게 시키는 게 낫지 않을까?**

## 데이터 수집
- 인스타그램에서 #턱스크, #마스크, #셀카 등 해시태그를 검색하여 이미지를 수집했다.
    - 총 데이터 4,840개를 수집했고, 불필요한 사진들을 삭제했다. 
    - 그리고 올바른 마스크 착용(1,796장, 44%) / 올바르지 않은 착용(2,289장, 56%)으로 직접 분류했다.

## 데이터 전처리
1. RGB2BGR convert
    * opencv로 이미지를 불러왔는데, 이미지가 퍼렇게 나왔다.
    * 알고보니, opencv는 BGR로 이미지를 불러오더라. 이를 RGB로 다시 컨버팅해줬다.
2. Face detection
    - 모델
    
    - 정확한 학습을 위해 일부 샘플을 포기하더라도 keras를 활용하여 제대로 얼굴만 분류
- 하지만 얼굴이 아닌데 얼굴이라고 인식하는 경우도 있었음.
    - 예를들어, 스타벅스 세이렌 로고 등 (사진 첨부하기)
- 이미지 배열화, BGR2RGB, resize, normalization 등의 전처리 수행

## 모델링

### 셀프 모델링

- 텐서플로우 직접 쌓기 no keras
    - 텐서플로우로?
    - numpy로 해보면?
- 직접 Convolutional Network 구현
    - 어떻게 층을 쌓았는지
    - 에폭, 학습률 등
- 한계점
    - 코스크를 잘 구별하지 못했다.
        - 이유는, 코스크의 사진이 부족했음.
    - 해결
        - Image generator 기법으로 기존 사진을 flip, crop, zoom함으로써 1,000개의 추가 샘플 생성
- 결과
    - 구현 사진

### VGG

- 모델 사진

### ResNet

- 모델 사진

### MobileNet

- 모델 사진

## 회고

- 데이터가 약 5,000개
    - 근데 왜 성능이 좋지?
    - 마스크 분류하는 문제가 어려운 문제가 아닌가?
        - 마스크 색상이랑 얼굴색상 다름
        - 입 코의 피처가 안 나옴
        - + 이진분류
- 필터에서 뽑은 잡아낸 패턴 시각화 가능할까?
    - Feature map visualization
    -
- 일정을 어떻게 맞췄는지
- Facedetection에 대한 아쉬운 부분
    - 모델들 비교나 원리같은거~?
